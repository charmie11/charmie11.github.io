<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>CR直列回路シミュレータ</title>
    <style>
      html, body {
        box-sizing: border-box;
        display: flow-root;
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-3.4.3.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.4.3.min.js"></script>
    <script type="text/javascript">
        Bokeh.set_log_level("info");
    </script>
  </head>
  <body>
    <div id="a13903c4-725b-41e7-a5a7-645554b487c4" data-root-id="p1583" style="display: contents;"></div>
  
    <script type="application/json" id="ef8b252a-c7ff-4dfc-9cc0-da2d3b1c270a">
      {"ae428af0-ef2f-4c8c-8945-33df3d9f92d5":{"version":"3.4.3","title":"Bokeh Application","roots":[{"type":"object","name":"Column","id":"p1583","attributes":{"children":[{"type":"object","name":"Row","id":"p1582","attributes":{"children":[{"type":"object","name":"Column","id":"p1580","attributes":{"children":[{"type":"object","name":"Slider","id":"p1512","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"type":"object","name":"CustomJS","id":"p1577","attributes":{"args":{"type":"map","entries":[["source",{"type":"object","name":"ColumnDataSource","id":"p1519","attributes":{"selected":{"type":"object","name":"Selection","id":"p1520","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1521"},"data":{"type":"map","entries":[["x",[0.0,2.7777777777777777,5.555555555555555,8.333333333333332,11.11111111111111,13.88888888888889,16.666666666666664,19.444444444444443,22.22222222222222,25.0]],["y",[0.0,0.3705840562219086,0.6038355697179345,0.7506477912227038,0.8430537441792865,0.9012155242701678,0.9378234759778836,0.9608651044517785,0.9753678727838592,0.9844961464009907]],["y_noisy",[0.0,0.3705840562219086,0.6038355697179345,0.7506477912227038,0.8430537441792865,0.9012155242701678,0.9378234759778836,0.9608651044517785,0.9753678727838592,0.9844961464009907]],["V",[1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0]],["R",[2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0]],["C",[3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0,3.0]],["S",[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]]]}}}],["voltage",{"id":"p1512"}],["period",{"type":"object","name":"Slider","id":"p1515","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p1577"}]]]},"title":"\u5468\u671f [\u79d2]","start":1.0,"end":180.0,"value":50.0}}],["resistance",{"type":"object","name":"Slider","id":"p1513","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"type":"object","name":"CustomJS","id":"p1517","attributes":{"args":{"type":"map","entries":[["resistance",{"id":"p1513"}],["capacitance",{"type":"object","name":"Slider","id":"p1514","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p1517"},{"id":"p1577"}]]]},"title":"\u9759\u96fb\u5bb9\u91cf [F]","start":1.0,"end":30.0,"value":3.0}}],["period",{"id":"p1515"}]]},"code":"\n        const tau = resistance.value * capacitance.value;\n        period.start = 0.1 * tau;\n        period.end = 30.0 * tau;\n        period.value = Math.min(Math.max(period.value, period.start), period.end);\n        period.step = 0.1 * tau;\n        period.change.emit();\n        "}},{"id":"p1577"}]]]},"title":"\u62b5\u6297 [Ohm]","start":1.0,"end":150.0,"value":2.0}}],["capacitance",{"id":"p1514"}],["samples",{"type":"object","name":"Slider","id":"p1516","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p1577"}]]]},"title":"\u30b5\u30f3\u30d7\u30eb\u6570 [\u56de/\u534a\u5468\u671f]","start":10,"end":2000,"value":10,"step":10}}],["noise_slider",{"type":"object","name":"Slider","id":"p1518","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:value",[{"id":"p1577"}]]]},"title":"\u30ce\u30a4\u30ba\u5f37\u5ea6","start":0.0,"end":1.0,"value":0.0,"step":0.1}}],["radio_group",{"type":"object","name":"RadioButtonGroup","id":"p1576","attributes":{"js_property_callbacks":{"type":"map","entries":[["change:active",[{"id":"p1577"}]]]},"labels":["\u5145\u96fb","\u653e\u96fb"],"active":0}}]]},"code":"\n        // \u5024\u306e\u53d6\u5f97\n        const V = voltage.value;\n        const T = period.value;\n        const R = resistance.value;\n        const C = capacitance.value;\n        const num_samples = samples.value;\n        const tau = R * C;\n        const times = Array.from(Array(num_samples).keys()).map(i =&gt; i * 0.5 * T / (num_samples-1));\n        const noise_scale = noise_slider.value;\n\n        let x = [];\n        let y = [];\n        let y_noisy = [];\n\n        // \u30e2\u30fc\u30c9\u306e\u9078\u629e\u306b\u57fa\u3065\u3044\u305f\u8a08\u7b97\n        if (radio_group.active === 0) {  // \u5145\u96fb\u30e2\u30fc\u30c9\n            x = times;\n            y = times.map(t =&gt; V * (1.0 - Math.exp(-t / tau)));\n            y = y.map(v =&gt; Math.min(v, V));  // \u6700\u5927\u5024\u3067\u30af\u30ea\u30c3\u30d7\n        } else {  // \u653e\u96fb\u30e2\u30fc\u30c9\n            x = times;\n            y = times.map(t =&gt; V * Math.exp(-t / tau));\n            y = y.map(v =&gt; Math.max(v, 0));  // \u6700\u5c0f\u5024\u3067\u30af\u30ea\u30c3\u30d7\n        }\n\n        // \u30ce\u30a4\u30ba\u306e\u8ffd\u52a0\n        const noise = y.map(() =&gt; (Math.random() - 0.5) * noise_scale);\n        y_noisy = y.map((v, i) =&gt; v + noise[i]);\n\n        // \u30c7\u30fc\u30bf\u306e\u66f4\u65b0\n        source.data = {\n            x: x,\n            y: y,\n            y_noisy: y_noisy,\n            V: Array(x.length).fill(V),\n            R: Array(x.length).fill(R),\n            C: Array(x.length).fill(C),\n            S: Array(x.length).fill(noise_scale),\n        };\n        source.change.emit();\n    "}}]]]},"title":"\u96fb\u6e90\u96fb\u5727 [V]","start":1.0,"end":20.0,"value":1.0}},{"id":"p1513"},{"id":"p1514"}]}},{"type":"object","name":"Column","id":"p1581","attributes":{"children":[{"id":"p1515"},{"id":"p1516"},{"id":"p1518"}]}}]}},{"id":"p1576"},{"type":"object","name":"Button","id":"p1578","attributes":{"button_type":"success","js_event_callbacks":{"type":"map","entries":[["button_click",[{"type":"object","name":"CustomJS","id":"p1579","attributes":{"args":{"type":"map","entries":[["source",{"id":"p1519"}],["radio_group",{"id":"p1576"}]]},"code":"\n        // \u6700\u65b0\u306e\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\n        const data = source.data;\n        const V = data['V'][0].toFixed(15);\n        const R = data['R'][0].toFixed(15);\n        const C = data['C'][0].toFixed(15);\n        const S = data['S'][0].toFixed(15);\n        const x = data['x'];\n        const y = data['y'];\n        const y_noisy = data['y_noisy'];\n\n        // \u30e9\u30b8\u30aa\u30dc\u30bf\u30f3\u306e\u9078\u629e\u72b6\u614b\u3092\u78ba\u8a8d\n        const selected_mode = radio_group.active === 0 ? 'charge' : 'discharge';\n\n        // CSV \u30c7\u30fc\u30bf\u306e\u751f\u6210\n        const csv = ['\u96fb\u6e90\u96fb\u5727 [V],\u62b5\u6297 [\u03a9],\u9759\u96fb\u5bb9\u91cf(\u771f\u5024) [F],\u30ce\u30a4\u30ba\u5f37\u5ea6,\u6642\u9593 [\u79d2],\u30b3\u30f3\u30c7\u30f3\u30b5\u306e\u7aef\u5b50\u96fb\u5727 [V],\u30ce\u30a4\u30ba\u3042\u308a\u30b3\u30f3\u30c7\u30f3\u30b5\u306e\u7aef\u5b50\u96fb\u5727 [V]'];\n        // 1\u884c\u76ee\n        csv.push([V, R, C, S, x[0].toFixed(15), y[0].toFixed(15), y_noisy[0].toFixed(15)].join(','));\n        for (let i = 1; i &lt; x.length; i++) {\n            csv.push(['', '', '', '', x[i].toFixed(15), y[i].toFixed(15), y_noisy[i].toFixed(15)].join(','));\n        }\n        const csvContent = csv.join('\\n');\n\n        // \u30d5\u30a1\u30a4\u30eb\u540d\u306e\u8a2d\u5b9a\n        const fileName = selected_mode === 'charge' ? 'charge_data.csv' : 'discharge_data.csv';\n\n        // CSV \u30d5\u30a1\u30a4\u30eb\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\n        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n        const link = document.createElement('a');\n        link.href = URL.createObjectURL(blob);\n        link.download = fileName;\n        link.click();\n        "}}]]]},"label":"\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9"}},{"type":"object","name":"Figure","id":"p1522","attributes":{"height":400,"x_range":{"type":"object","name":"DataRange1d","id":"p1523"},"y_range":{"type":"object","name":"DataRange1d","id":"p1524"},"x_scale":{"type":"object","name":"LinearScale","id":"p1532"},"y_scale":{"type":"object","name":"LinearScale","id":"p1533"},"title":{"type":"object","name":"Title","id":"p1525","attributes":{"text":"\u30b3\u30f3\u30c7\u30f3\u30b5\u306e\u7aef\u5b50\u96fb\u5727\u306e\u9077\u79fb"}},"renderers":[{"type":"object","name":"GlyphRenderer","id":"p1559","attributes":{"data_source":{"id":"p1519"},"view":{"type":"object","name":"CDSView","id":"p1560","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1561"}}},"glyph":{"type":"object","name":"Scatter","id":"p1556","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y_noisy"},"line_color":{"type":"value","value":"red"},"fill_color":{"type":"value","value":"red"},"hatch_color":{"type":"value","value":"red"}}},"nonselection_glyph":{"type":"object","name":"Scatter","id":"p1557","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y_noisy"},"line_color":{"type":"value","value":"red"},"line_alpha":{"type":"value","value":0.1},"fill_color":{"type":"value","value":"red"},"fill_alpha":{"type":"value","value":0.1},"hatch_color":{"type":"value","value":"red"},"hatch_alpha":{"type":"value","value":0.1}}},"muted_glyph":{"type":"object","name":"Scatter","id":"p1558","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y_noisy"},"line_color":{"type":"value","value":"red"},"line_alpha":{"type":"value","value":0.2},"fill_color":{"type":"value","value":"red"},"fill_alpha":{"type":"value","value":0.2},"hatch_color":{"type":"value","value":"red"},"hatch_alpha":{"type":"value","value":0.2}}}}},{"type":"object","name":"GlyphRenderer","id":"p1570","attributes":{"data_source":{"id":"p1519"},"view":{"type":"object","name":"CDSView","id":"p1571","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1572"}}},"glyph":{"type":"object","name":"Scatter","id":"p1567","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":{"type":"value","value":"#1f77b4"},"fill_color":{"type":"value","value":"#1f77b4"}}},"nonselection_glyph":{"type":"object","name":"Scatter","id":"p1568","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":{"type":"value","value":"#1f77b4"},"line_alpha":{"type":"value","value":0.1},"fill_color":{"type":"value","value":"#1f77b4"},"fill_alpha":{"type":"value","value":0.1},"hatch_alpha":{"type":"value","value":0.1}}},"muted_glyph":{"type":"object","name":"Scatter","id":"p1569","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"line_color":{"type":"value","value":"#1f77b4"},"line_alpha":{"type":"value","value":0.2},"fill_color":{"type":"value","value":"#1f77b4"},"fill_alpha":{"type":"value","value":0.2},"hatch_alpha":{"type":"value","value":0.2}}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p1531","attributes":{"tools":[{"type":"object","name":"PanTool","id":"p1544"},{"type":"object","name":"WheelZoomTool","id":"p1545","attributes":{"renderers":"auto"}},{"type":"object","name":"BoxZoomTool","id":"p1546","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p1547","attributes":{"syncable":false,"level":"overlay","visible":false,"left":{"type":"number","value":"nan"},"right":{"type":"number","value":"nan"},"top":{"type":"number","value":"nan"},"bottom":{"type":"number","value":"nan"},"left_units":"canvas","right_units":"canvas","top_units":"canvas","bottom_units":"canvas","line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}},{"type":"object","name":"ResetTool","id":"p1552"}]}},"left":[{"type":"object","name":"LinearAxis","id":"p1539","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1540","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"PrintfTickFormatter","id":"p1575","attributes":{"format":"%.1f"}},"axis_label":"\u96fb\u5727 [V]","major_label_policy":{"type":"object","name":"AllLabels","id":"p1542"}}}],"below":[{"type":"object","name":"LinearAxis","id":"p1534","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1535","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"PrintfTickFormatter","id":"p1574","attributes":{"format":"%.1f"}},"axis_label":"\u6642\u9593 [\u79d2]","major_label_policy":{"type":"object","name":"AllLabels","id":"p1537"}}}],"center":[{"type":"object","name":"Grid","id":"p1538","attributes":{"axis":{"id":"p1534"}}},{"type":"object","name":"Grid","id":"p1543","attributes":{"dimension":1,"axis":{"id":"p1539"}}},{"type":"object","name":"Legend","id":"p1562","attributes":{"location":"center_right","items":[{"type":"object","name":"LegendItem","id":"p1563","attributes":{"label":{"type":"value","value":"\u30ce\u30a4\u30ba\u3042\u308a"},"renderers":[{"id":"p1559"}]}},{"type":"object","name":"LegendItem","id":"p1573","attributes":{"label":{"type":"value","value":"\u30ce\u30a4\u30ba\u306a\u3057"},"renderers":[{"id":"p1570"}]}}]}}]}}]}}]}}
    </script>
    <script type="text/javascript">
      (function() {
        const fn = function() {
          Bokeh.safely(function() {
            (function(root) {
              function embed_document(root) {
              const docs_json = document.getElementById('ef8b252a-c7ff-4dfc-9cc0-da2d3b1c270a').textContent;
              const render_items = [{"docid":"ae428af0-ef2f-4c8c-8945-33df3d9f92d5","roots":{"p1583":"a13903c4-725b-41e7-a5a7-645554b487c4"},"root_ids":["p1583"]}];
              root.Bokeh.embed.embed_items(docs_json, render_items);
              }
              if (root.Bokeh !== undefined) {
                embed_document(root);
              } else {
                let attempts = 0;
                const timer = setInterval(function(root) {
                  if (root.Bokeh !== undefined) {
                    clearInterval(timer);
                    embed_document(root);
                  } else {
                    attempts++;
                    if (attempts > 100) {
                      clearInterval(timer);
                      console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
                    }
                  }
                }, 10, root)
              }
            })(window);
          });
        };
        if (document.readyState != "loading") fn();
        else document.addEventListener("DOMContentLoaded", fn);
      })();
    </script>
  </body>
</html>